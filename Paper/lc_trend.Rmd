---
output: pdf_document
---

# Trend

Does affect go up or down across time, or is it relatively stable? Does trainee skill increase over the training session? These are questions about trend, and these first two are specifically about linear trend. It is also possible to explore how variables bend or curve across time. Do newcomer perceptions of climate increase and then plateau over time? Does the response time of a medical team decrease with each successive case but then remain stable once the team can no longer improve their coordination? These latter questions concern curvilinear trajectories. 

Trend has to do with the global shape of the trajectory across time. If we put a variable on the $y$-axis and plot its values against time on the $x$-axis, do the values tend to go up or down over time? It can be thought of as the coarse-grained direction of a trajectory. 

Figure \ref{trend} demonstrates trend, where the red line shows negative, decreasing trend, the blue line shows positive, increasing trend, and the green line shows a curvilinear trajectory. Keep in mind that curvilinear and linear trajectories are both *linear in parameters* and should not be confused with non-linear systems. 

\begin{center}

------------

Insert Figure \ref{trend} about here

------------

\end{center}

Our first trend inference, therefore, concerns the shape of the trajectory.

>> **Inference 1:** There is positive/negative/curvilinear trend in a variable across time. 

As with the level inferences, when we add more units we can examine trend variability. Do all trainees develop greater skill across time? Is there variability in the trend of helping behaviors, or counterproductive work behaviors over time? 

Figure \ref{trend_var} shows differences in trend variability. In the first facet all units (people) show the same positive trend, whereas everyone in the second facet shows different trend: person one's data appear to increase over time, person two's data decrease over time, and person three's data remain flat. With greater variability there is less consistency in trend across units.

\begin{center}

------------

Insert Figure \ref{trend_var} about here

------------

\end{center}

>> **Inference 2:** There is variability in the trend of a variable across time; trend differs across units.

Inferences one and two are about one variable, but they can also be iterated across all observed variables. For example, we might discover that affect and performance trends both decrease, but there is greater variability across units in the affect trend. Or we might learn that affect has a negative trend while performance has a positive trend.

Correlating these trends is the next inference. Correlating indicates co-occuring patterns, but this time we focus on trends rather than levels. A large positive correlation between affect and performance trends indicates that people with a positive affect trend (usually) have a positive performance trend and people with a negative affect trend (usually) have a negative performance trend. 

Figure \ref{trend_correlation} shows the inuition behind the inference with a set of graphs. In Panel A we plot affect and performance across time for three individuals. Affect goes up while performance goes down for person one, this pattern is reversed for person two, and person three reports trendless affect and performance (i.e., zero trend), but both variables fluctuate across time for this individual. We use different colors to label the trends for each person. The affect and performance trends for person one are labeled with red lines, whereas person two has green lines and person three has blue lines.

Panel B then maps those pairings onto a figure that shows the relationship between the affect and performance trend. For example, person one has a positive affect trend and a negative performance trend, so their value in Panel B goes on the bottom right, whereas person two has the opposite pattern and therefore is placed on the top left (where the performance trend is positive and the affect trend is negative). Producing this bottom scatter plot tells us that the relationship between the affect and performance trend is negative. That is, people with a positive affect trend usually have a negative performance trend, people with a negative affect trend are more likely to have a positive performance trend, and people with no affect trend usually have no performance trend. 

\begin{center}

------------

Insert Figure \ref{trend_correlation} about here

------------

\end{center}

>> **Inference 3:** There are correlated trends.

The final trend inference is about identifying covariates or predictors of trend. Does gender predict depletion trends? Does the trend in unit climate covary with between unit differences in leader quality? Notice the difference between this inference and inference three. Inference three asks how one trend is related to another, whereas this inference asks how one trend relates to a covariate.

Figure \ref{trend_covariate} demonstrates the inference in a plot. We plot affect across time for six employees, and these employees differ by job type. The first three individuals work in research and development, whereas the final three individuals work in sales. Affect trajectories tend to decrease over time for employees in research and development, whereas affect trajectories tend to increase for those in sales. An individual's job type, then, gives us a clue to their likely affect trend -- said formally, job type covaries with affect trends, such that we expect individuals in sales to have positive affect trends and individuals in research and development to have negative affect trends. The expected trends are plotted as the thick blue lines. 


\begin{center}

------------

Insert Figure \ref{trend_covariate} about here

------------

\end{center}


>> **Inference 4:** There are correlates of trend. 

## Trend Inference Table

The inference table below provides examples of each trend inference. Inference one is about the general direction or shape of a trajectory across time. Inference two is about variability in that shape across units. Inference three takes the trend in one variable and asks whether it co-occurs with trend in another. Inference four, finally, is about the relationship between trend in one variable and the raw values of one or more correlates.

\begin{center}

------------

Insert Table \ref{trend_table} about here

------------

\end{center}

We want to close this section with a note on phrasing. The inferences we explored in this section have to do with correlating trends, where a statement like "affect and performance trends covary, such that people with a negative affect trend have a positive performance trend" is appropriate. There is a less precise phrase that is easy to fall into -- and we have seen it used in our literature. Sometimes, researchers will correlate trends and then state, "when affect decreases performance goes up." We urge researchers to avoid this second statement because it is not clear if it refers to a static relationship about trends or a dynamic statement about how trajectories move across time. That is, the phrase "when affect decreases performance goes up" could refer to correlated trends, but it could also mean something like, "when affect decreases performance immediately or subsequently goes up." This second statement is far different and it should not be used when an analysis only correlates trends or evokes predictors of trend. Again, we urge researchers to phrase their inferences as we have shown here.


## Models

Trends are called slope estimates in the statistical modeling literature. They are also referred to as growth. Mean estimates of slopes, or trends, or growth will tell you about trend, whereas the variance estimates will tell you about variability across units. Growth curves in SEM or HLM. Bivariate growth curves. 



```{r, echo = F}
library(xtable)
library(knitr)
library(kableExtra)
library(tidyverse)

inference_text2 <- c('There is positive/negative/curvilinear trend in a variable across time.?',
                    'There is variability in the trend of a variable across time. Trend differs across units.',
                    'There are correlated trends. There is a relationship between two trends.',
                    'There are correlates/predictors of trend.')
trend_table <- data.frame(
  Inference = c(1, 2, 3, 4),
  Examples = c(linebreak('Burnout decreases over time.\nPerformance increases over time.'),
                 linebreak('Affect trends differ across people (units).\nThere is variability in turnover trends across organizations.'),
                 linebreak('People with a positive health status trend have a positive happiness trend.\nPeople with a positive performance trend have a negative anxiety trend.'),
                 linebreak('Gender correlates with depletion trends.\nUnit climate covaries with unit performance trends.'))
)

trend_table %>%
  kable('latex', booktabs = T, escape = F, align = 'l', caption = '\\label{trend_table}Examples of trend inferences.') %>%
    column_spec(1, width = '5em') %>%
    column_spec(2, width = '30em') %>%
  row_spec(1:3, hline_after = T)


```



```{r, echo = F, fig.cap = 'Trend across time.\\label{trend}'}
set.seed(3)

ind <- c(1:20)
chris <- 4 + 0.7*ind + rnorm(20,0,0.5)
josh <- 4 - 0.7*ind  + rnorm(20, 0, 0.5)
chris[1] <- 4
josh[1] <- 4
#timothy <- c(4, 5, 15, 18, 21, 20, 19, 17, -6, -10, -12, -16, -14, 0, 1,2,3,4,5,9)
timothy <- 15*sin(ind/3)

fam <- data.frame(
  'Time' = c(ind, ind, ind),
  'Y' = c(chris, josh, timothy),
  'legend' = c(rep('Positive Trend', 20), rep('Negative Trend', 20), rep('Curvilinear Trend', 20))
)

hm <- data.frame(
  'Time' = c(ind),
  'Y' = c(timothy)
)

library(ggplot2)
ggplot(fam, aes(x = Time, y = Y, color = legend)) + 
  geom_point(alpha = 0.6) + 
  geom_abline(intercept = 4, slope = 0.7, color = 'blue', alpha = 0.5) +
  geom_abline(intercept = 4, slope = -0.7, color = 'red', alpha = 0.5) + 
  scale_y_continuous(labels = NULL) + 
  theme_classic() + 
  theme(legend.title = element_blank()) + 
  scale_color_manual(values = c('Positive Trend' = 'blue', 
                                'Negative Trend' = 'red',
                                'Curvilinear Trend' = 'green'),
                     breaks = c('Positive Trend', 
                                'Negative Trend',
                                'Curvilinear Trend')) + 
  geom_smooth(data = hm, aes(x = Time, y = Y), se = F, color = 'green', alpha = 0.6, size = 0.5, alpha = 0.2)


```

```{r, echo = F, fig.cap = 'Differences in trend variability across units.\\label{trend_var}'}
set.seed(88)

per1 <- 4 + 0.6*ind + rnorm(20, 0, 0.5)
per2 <- 4 + 0.6*ind + rnorm(20, 0, 2)
per3 <- 4 + 0.6*ind + rnorm(20, 0, 0.5)

per4 <- 4 + 0.6*ind + rnorm(20, 0, 1)
per5 <- 4 - 0.9*ind + rnorm(20, 0, 1)
per6 <- 4 + 0.01*ind + rnorm(20,0,1)


yup <- data.frame(
  'Time' = c(ind, ind, ind, ind, ind, ind),
  'Y' = c(per1, per2, per3, per4, per5, per6),
  'Person' = c(rep('Person 1', 20),
               rep("Person 2", 20),
               rep('Person 3', 20),
               rep('Person 1', 20),
               rep('Person 2', 20),
               rep('Person 3', 20)),
  'type' = c(rep('No Trend Variability', 60),
             rep('Trend Variability', 60))
)


ggplot(yup, aes(x = Time, y = Y, color = Person)) + 
  geom_point(alpha = 0.6) + 
  geom_smooth(method = 'lm', se = F, aes(color = Person), size = 0.5, alpha = 0.6) + 
  facet_wrap(~type) + 
  theme_classic() + 
  theme(legend.title = element_blank()) + 
  scale_y_continuous(labels = NULL) + 
  scale_color_manual(values = c('Person 1' = 'red',
                                'Person 2' = 'green',
                                'Person 3' = 'blue')
                     )



```


```{r, echo = F, fig.cap = 'Correlating slopes, or relating the affect to performance trend.\\label{trend_correlation}', fig.height = 10}

set.seed(33)
tre_affect <- 6 + 0.6*ind + rnorm(20,0,1)
tre_perf <- 2 - 0.6*ind + rnorm(20,0,1)

affect2 <- 6- 0.6*ind + rnorm(20,0,1)
perf2 <- 2 + 0.6*ind + rnorm(20,0,1)

affect3 <- 5 + 0.02*ind + rnorm(20,0,1)
perf3 <- 5 + 0.01*ind + rnorm(20,0,1)

trend_rel <- data.frame(
  'Time' = c(ind, ind,
             ind, ind,
             ind, ind),
  'Value' = c(tre_affect, tre_perf,
          affect2, perf2,
          affect3, perf3),
  'call' = c(rep('Affect', 20),
              rep('Performance', 20),
             rep('Affect', 20),
             rep('Performance', 20),
             rep('Affect', 20),
             rep('Performance', 20)),
  'Person' = c(rep('Person 1', 40),
               rep('Person 2', 40),
               rep('Person 3', 40))
)

trend_lines <- data.frame(
  'Person' = c('Person 1',
          'Person 1',
          'Person 2',
          'Person 2',
          'Person 3',
          'Person 3'),
  'call' = c('Affect',
             'Performance',
             'Affect', 
             'Performance',
             'Affect',
             'Performance'),
  'intercept' = c(6, 2,
                  6, 2, 
                  5, 5),
  'slope' = c(0.6, -0.6,
              -0.6, 0.6,
              0.02, 0.01)
)

tp1 <- ggplot(trend_rel, aes(x = Time, y = Value, group = call)) + 
  geom_line(aes(linetype = call)) + 
  theme_classic() + 
  scale_y_continuous(labels = NULL) + 
  theme(legend.title = element_blank()) + 
  facet_grid(~Person, scales = 'free', space = 'free') + 
  geom_abline(aes(intercept = intercept, slope = slope, color = Person), data = trend_lines, alpha = 0.9, show.legend = F) + 
  scale_color_manual(values = c('Person 1' = 'red',
                                'Person 2' = 'green',
                                'Person 3' = 'blue')) + 
  ggtitle('Panel A')
  



trend_trend <- data.frame(
  'Affect' = c(-0.8, 0, 0.8),
  'Performance' = c(0.8, 0, -0.8),
  'label' = c('green', 'blue', 'red')
)

tp2 <- ggplot(trend_trend, aes(x = Affect, y = Performance, color = label)) + 
  geom_point(size = 6, alpha = 0.6) + 
  theme_classic() + 
  scale_y_continuous(breaks = c(-1, 0, 1)) + 
  scale_x_continuous(breaks = c(-1, 0, 1)) + 
  ylab("Trend in Performance") + 
  xlab("Trend in Affect") + 
  ggtitle('Panel B') + 
  theme(legend.title = element_blank()) + 
  scale_color_manual(values = c('red' = 'red', 
                                'blue' = 'blue',
                                'green' = 'green'),
                     labels = c('Person 3',
                                'Person 2',
                                'Person 1'))
                     #breaks = c('Person 1',
                          #      'Person 2',
                           #     'Person 3'))

library(gridExtra)

grid.arrange(tp1, tp2, ncol = 1)

```

```{r, echo = F, fig.cap = 'Job type as a covariate of affect trend.\\label{trend_covariate}'}

library(ggplot2)
library(tidyverse)

xs <- c(1:20)

person1 <- 4 + 0.5*xs + rnorm(20,0,1)
person2 <- 4 + 0.6*xs + rnorm(20,0,1)
person3 <- 4 + 0.36*xs + rnorm(20,0,1)

person4 <- 4 - 0.5*xs + rnorm(20,0,1)
person5 <- 4 - 0.45*xs + rnorm(20,0,1)
person6 <- 4 - 0.68*xs + rnorm(20, 0, 1)


covary_trend_df <- data.frame(
  'id' = c(rep('Person 6',20), rep('Person 5',20), rep('Person 4',20),
           rep('Person 3',20), rep('Person 2',20), rep('Person 1',20)),
  'affect' = c(person1, person2, person3,
               person4, person5, person6),
  'time' = c(xs, xs, xs,
             xs, xs, xs),
  'job_type' = c(rep('Sales', 60),
                 rep('Research and Development', 60))
  
)

trend_df <- data.frame(
  'id' = c('Person 6',
           'Person 5',
           'Person 4',
           'Person 3',
           'Person 2',
           'Person 1'),
  'intercept' = c(rep(4, 6)),
  'slope' = c(rep(0.45, 3),
              rep(-0.52, 3)),
  'job_type' = c(rep('Sales', 3),
                 rep('Research and Development', 3))
)

ggplot(covary_trend_df, aes(x = time, y = affect, linetype = id)) + 
  geom_point() + 
  geom_line() + 
  theme_classic() +
  theme(legend.title = element_blank()) + 
  ylab('Affect') + 
  xlab('Time') + 
  scale_y_continuous(labels = NULL) + 
  facet_wrap(~job_type) + 
  geom_abline(data = trend_df, aes(intercept = intercept, slope = slope, color = id), alpha = 0.2, show.legend = F, size = 4) + 
  scale_color_manual(values = c('Person 1' = 'blue',
                                'Person 2' = 'blue',
                                'Person 3' = 'blue',
                                'Person 4' = 'blue',
                                'Person 5' = 'blue',
                                'Person 6' = 'blue'))
  



```



